<!doctype html>
<html lang="sk">

<head>
    <meta charset="UTF-8" />
    <title>Skúškové zadanie</title>
    <script src="script.js" async></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Skúškové zadanie</h1>
    <div id="myDiv">
    <hr>
    <br>
    <form>
        <label for="userName">Meno používateľa:</label>
        <br>
        <input type="text" id="userName" name="userName" placeholder="Zadaj meno používateľa...">
        <br>
        <input type="submit" id="userNameButton" value="Potvrď">
    </form>
    <br>
    <hr>
    <br>
    <form>
        <label for="inputOctaveCode">Výška prekážky (r):</label>
        <br>
        <input type="number" max="0.3" min="-0.3" onkeyup="if(parseInt(this.value)>0.4){ this.value =0.3; return false; } else if(parseInt(this.value)<-0.4){ this.value =-0.3; return false; }" id="inputOctaveCode" name="inputOctaveCode">
        <br>
        <input type="submit" id="inputOctaveCodeButton" value="Potvrď">
    </form>
    <br>
    <hr>
    </div>

    <div id="chart">
        <canvas id="myChart" width="600" height="400"></canvas>
    </div>


<script>
    const inputOctaveCode = document.querySelector("#inputOctaveCode");
    const inputOctaveCodeButton = document.querySelector("#inputOctaveCodeButton");

    let r = 0;
    let x1 = 0;
    let x2 = 0;
    let x3 = 0;
    let x4 = 0;
    let x5 = 0;

    inputOctaveCodeButton.addEventListener('click', () => {
        r = inputOctaveCode.value;

        let requestBody = { "r": r, "x1": x1, "x2": x2, "x3": x3, "x4": x4, "x5": x5};
        async function fun(){
            return fetch('https://site131.webte.fei.stuba.sk/skuskove_zadanie/server/computer_aided_system/suspension_system_car/index.php?token=bf78172a88287685b0b4d86c1325abfe1f5e501c', {
                method: 'post',
                body: JSON.stringify(requestBody)

            }).then(
                response => response.json().then(data => ({status: response.status, body: data}))
            )
        }
        const resBody = fun();

        const saveXVariables = async () => {
            const a = await resBody;
            x1 = a.body.x[500][0];
            x2 = a.body.x[500][1];
            x3 = a.body.x[500][2];
            x4 = a.body.x[500][3];
            x5 = a.body.x[500][4];
        };

        saveXVariables();

        //console.log(x1);
    })


</script>
</body>
</html>